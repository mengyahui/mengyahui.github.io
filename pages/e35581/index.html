<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>默认日志管理与logback | MYH&#39;s Blog</title>
    <meta name="generator" content="VuePress 1.9.5">
    <script src="https://cdn.jsdelivr.net/npm/react/umd/react.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/react-dom/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.min.js"></script>
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="web前端技术博客,专注web前端学习与总结。JavaScript,js,ES6,TypeScript,vue,React,python,css3,html5,Node,git,github等技术文章。">
    <meta name="keywords" content="博客,个人技术博客,后端,后端开发,后端框架,web前端,后端面试题,技术文档,学习,面试,Java,SpringBoot,MyBatis,MySQL,vue,Redis,SpringCloud,Nginx,MongoDB,git,Docker,markdown">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.042d882d.css" as="style"><link rel="preload" href="/assets/js/app.67223bcb.js" as="script"><link rel="preload" href="/assets/js/2.316bc55b.js" as="script"><link rel="preload" href="/assets/js/28.39252e9a.js" as="script"><link rel="prefetch" href="/assets/js/10.a19925fb.js"><link rel="prefetch" href="/assets/js/11.526b83d6.js"><link rel="prefetch" href="/assets/js/12.5565edc8.js"><link rel="prefetch" href="/assets/js/13.3d6970aa.js"><link rel="prefetch" href="/assets/js/14.8eedc93a.js"><link rel="prefetch" href="/assets/js/15.d2da9468.js"><link rel="prefetch" href="/assets/js/16.c8ffcd7f.js"><link rel="prefetch" href="/assets/js/17.79b69729.js"><link rel="prefetch" href="/assets/js/18.55f1e803.js"><link rel="prefetch" href="/assets/js/19.f1227afb.js"><link rel="prefetch" href="/assets/js/20.e45349ee.js"><link rel="prefetch" href="/assets/js/21.1d53685b.js"><link rel="prefetch" href="/assets/js/22.59de4a41.js"><link rel="prefetch" href="/assets/js/23.35180819.js"><link rel="prefetch" href="/assets/js/24.8d404f24.js"><link rel="prefetch" href="/assets/js/25.3a005120.js"><link rel="prefetch" href="/assets/js/26.68cd2eea.js"><link rel="prefetch" href="/assets/js/27.39d3184a.js"><link rel="prefetch" href="/assets/js/29.8cfc649d.js"><link rel="prefetch" href="/assets/js/3.9a800561.js"><link rel="prefetch" href="/assets/js/30.8b9d3130.js"><link rel="prefetch" href="/assets/js/31.615bad2f.js"><link rel="prefetch" href="/assets/js/32.6ed3ef0f.js"><link rel="prefetch" href="/assets/js/33.66731721.js"><link rel="prefetch" href="/assets/js/34.1579207c.js"><link rel="prefetch" href="/assets/js/35.86ff114a.js"><link rel="prefetch" href="/assets/js/36.4aa49dd5.js"><link rel="prefetch" href="/assets/js/37.d6a0a8ea.js"><link rel="prefetch" href="/assets/js/38.cdd7fc8e.js"><link rel="prefetch" href="/assets/js/39.34a896dc.js"><link rel="prefetch" href="/assets/js/4.d1b60869.js"><link rel="prefetch" href="/assets/js/40.d3ba7ebb.js"><link rel="prefetch" href="/assets/js/41.13dd3c48.js"><link rel="prefetch" href="/assets/js/42.44d4fbb4.js"><link rel="prefetch" href="/assets/js/43.0679497a.js"><link rel="prefetch" href="/assets/js/44.09c31938.js"><link rel="prefetch" href="/assets/js/45.40d49eef.js"><link rel="prefetch" href="/assets/js/46.3aa471f6.js"><link rel="prefetch" href="/assets/js/47.db96e5fd.js"><link rel="prefetch" href="/assets/js/48.5e0e4526.js"><link rel="prefetch" href="/assets/js/49.a3a85982.js"><link rel="prefetch" href="/assets/js/5.251bc32b.js"><link rel="prefetch" href="/assets/js/50.9ba01c48.js"><link rel="prefetch" href="/assets/js/51.dd99cdbc.js"><link rel="prefetch" href="/assets/js/52.6df8e45e.js"><link rel="prefetch" href="/assets/js/53.1e4cb3b8.js"><link rel="prefetch" href="/assets/js/54.3f0aee84.js"><link rel="prefetch" href="/assets/js/55.90b58b90.js"><link rel="prefetch" href="/assets/js/56.1ae97e41.js"><link rel="prefetch" href="/assets/js/57.4c7cbc1f.js"><link rel="prefetch" href="/assets/js/58.b60428fc.js"><link rel="prefetch" href="/assets/js/59.357d5e5e.js"><link rel="prefetch" href="/assets/js/6.559acfe3.js"><link rel="prefetch" href="/assets/js/7.74bb28c3.js"><link rel="prefetch" href="/assets/js/8.45d5678b.js"><link rel="prefetch" href="/assets/js/9.52b09d04.js">
    <link rel="stylesheet" href="/assets/css/0.styles.042d882d.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="MYH's Blog" class="logo"> <span class="site-name can-hide">MYH's Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/front-end/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/24a8e1/" class="nav-link">CSS</a></li><li class="dropdown-item"><!----> <a href="/pages/f4d72c/" class="nav-link">Vue</a></li><li class="dropdown-item"><!----> <a href="/pages/e44a21/" class="nav-link">JavaScript</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><a href="/back-end/" class="link-title">后端</a> <span class="title" style="display:none;">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/cd256c/" class="nav-link">SpringBoot</a></li><li class="dropdown-item"><!----> <a href="/pages/58a1d3/" class="nav-link">SpringCloud</a></li><li class="dropdown-item"><!----> <a href="/pages/b81f92/" class="nav-link">MyBatis</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><a href="/database/" class="link-title">数据库</a> <span class="title" style="display:none;">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/680c6f/" class="nav-link">elasticsearch</a></li><li class="dropdown-item"><!----> <a href="/pages/330887/" class="nav-link">mysql</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><a href="/tools/" class="link-title">工具</a> <span class="title" style="display:none;">工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/01e90a/" class="nav-link">Git</a></li><li class="dropdown-item"><!----> <a href="/pages/f8ef21/" class="nav-link">Docker</a></li><li class="dropdown-item"><!----> <a href="/pages/3a7e1b/" class="nav-link">Nginx</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/f1db9f/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/pages/3c70e5/" class="nav-link">面试</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/logo.png"> <div class="blogger-info"><h3>MYH</h3> <span>这家伙很懒，什么都没写......</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/front-end/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/24a8e1/" class="nav-link">CSS</a></li><li class="dropdown-item"><!----> <a href="/pages/f4d72c/" class="nav-link">Vue</a></li><li class="dropdown-item"><!----> <a href="/pages/e44a21/" class="nav-link">JavaScript</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><a href="/back-end/" class="link-title">后端</a> <span class="title" style="display:none;">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/cd256c/" class="nav-link">SpringBoot</a></li><li class="dropdown-item"><!----> <a href="/pages/58a1d3/" class="nav-link">SpringCloud</a></li><li class="dropdown-item"><!----> <a href="/pages/b81f92/" class="nav-link">MyBatis</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><a href="/database/" class="link-title">数据库</a> <span class="title" style="display:none;">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/680c6f/" class="nav-link">elasticsearch</a></li><li class="dropdown-item"><!----> <a href="/pages/330887/" class="nav-link">mysql</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><a href="/tools/" class="link-title">工具</a> <span class="title" style="display:none;">工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/01e90a/" class="nav-link">Git</a></li><li class="dropdown-item"><!----> <a href="/pages/f8ef21/" class="nav-link">Docker</a></li><li class="dropdown-item"><!----> <a href="/pages/3a7e1b/" class="nav-link">Nginx</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/f1db9f/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/pages/3c70e5/" class="nav-link">面试</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>SpringBoot</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/cd256c/" class="sidebar-link">SpringBoot简介</a></li><li><a href="/pages/5cf0cf/" class="sidebar-link">创建SpringBoot项目与HelloWorld解析</a></li><li><a href="/pages/43b14b/" class="sidebar-link">SpringBoot配置文件</a></li><li><a href="/pages/3e3e97/" class="sidebar-link">SpringBoot读取配置</a></li><li><a href="/pages/3d8091/" class="sidebar-link">项目启动Banner配置</a></li><li><a href="/pages/e35581/" aria-current="page" class="active sidebar-link">默认日志管理与logback</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/e35581/#一、如何选择日志框架" class="sidebar-link">一、如何选择日志框架？</a></li><li class="sidebar-sub-header level2"><a href="/pages/e35581/#二、日志元素" class="sidebar-link">二、日志元素</a></li><li class="sidebar-sub-header level2"><a href="/pages/e35581/#三、日志输出" class="sidebar-link">三、日志输出</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/e35581/#_3-1-设置日志级别" class="sidebar-link">3.1 设置日志级别</a></li><li class="sidebar-sub-header level3"><a href="/pages/e35581/#_3-2-打印日志" class="sidebar-link">3.2 打印日志</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/e35581/#四、日志配置" class="sidebar-link">四、日志配置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/e35581/#_4-1日志持久化" class="sidebar-link">4.1日志持久化</a></li><li class="sidebar-sub-header level3"><a href="/pages/e35581/#_4-2-自定义日志格式" class="sidebar-link">4.2 自定义日志格式</a></li><li class="sidebar-sub-header level3"><a href="/pages/e35581/#_4-3-自定义日志配置文件" class="sidebar-link">4.3 自定义日志配置文件</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/e35581/#五、logback-spring-xml-解析" class="sidebar-link">五、logback-spring.xml 解析</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/e35581/#_5-1-根节点-configuration" class="sidebar-link">5.1 根节点：&lt;configuration&gt;</a></li><li class="sidebar-sub-header level3"><a href="/pages/e35581/#_5-2-子节点-root" class="sidebar-link">5.2 子节点：&lt;root&gt;</a></li><li class="sidebar-sub-header level3"><a href="/pages/e35581/#_5-3-子节点-contentname" class="sidebar-link">5.3 子节点 ： &lt;contentName&gt;</a></li><li class="sidebar-sub-header level3"><a href="/pages/e35581/#_5-4-子节点-ptoperty" class="sidebar-link">5.4 子节点：&lt;ptoperty&gt;</a></li><li class="sidebar-sub-header level3"><a href="/pages/e35581/#_5-5-子节点-logger" class="sidebar-link">5.5 子节点：&lt;logger&gt;</a></li><li class="sidebar-sub-header level3"><a href="/pages/e35581/#_5-6-子节点-appender" class="sidebar-link">5.6 子节点：&lt;appender&gt;</a></li><li class="sidebar-sub-header level4"><a href="/pages/e35581/#_5-6-1-consoleappender" class="sidebar-link">5.6.1 ConsoleAppender</a></li><li class="sidebar-sub-header level4"><a href="/pages/e35581/#_5-6-2-fileappender" class="sidebar-link">5.6.2 FileAppender</a></li><li class="sidebar-sub-header level4"><a href="/pages/e35581/#_5-6-3-rollingfileappender" class="sidebar-link">5.6.3 RollingFileAppender</a></li><li class="sidebar-sub-header level3"><a href="/pages/e35581/#_5-7-滚动策略" class="sidebar-link">5.7 滚动策略</a></li><li class="sidebar-sub-header level4"><a href="/pages/e35581/#_5-7-1-timebasedrollingpolicy" class="sidebar-link">5.7.1 TimeBasedRollingPolicy</a></li><li class="sidebar-sub-header level4"><a href="/pages/e35581/#_5-7-2-sizeandtimebasedrollingpolicy" class="sidebar-link">5.7.2 SizeAndTimeBasedRollingPolicy</a></li><li class="sidebar-sub-header level4"><a href="/pages/e35581/#_5-7-3-fixedwindowrollingpolicy" class="sidebar-link">5.7.3 FixedWindowRollingPolicy</a></li><li class="sidebar-sub-header level3"><a href="/pages/e35581/#_5-8-过滤器-filter" class="sidebar-link">5.8 过滤器：&lt;filter&gt;</a></li><li class="sidebar-sub-header level4"><a href="/pages/e35581/#_5-8-1-过滤器的分类" class="sidebar-link">5.8.1 过滤器的分类</a></li><li class="sidebar-sub-header level4"><a href="/pages/e35581/#_5-8-2-状态枚举-filterreply" class="sidebar-link">5.8.2  状态枚举 FilterReply</a></li><li class="sidebar-sub-header level4"><a href="/pages/e35581/#_5-8-3-thresholdfilter" class="sidebar-link">5.8.3 ThresholdFilter</a></li><li class="sidebar-sub-header level4"><a href="/pages/e35581/#_5-8-4-evaluatorfilter" class="sidebar-link">5.8.4 EvaluatorFilter</a></li></ul></li></ul></li><li><a href="/pages/0fb413/" class="sidebar-link">Web开发：静态资源配置</a></li><li><a href="/pages/ca97de/" class="sidebar-link">Web开发：参数校验</a></li><li><a href="/pages/06bcb8/" class="sidebar-link">Web开发：异常处理</a></li><li><a href="/pages/9be92c/" class="sidebar-link">Web开发：CORS解决跨域</a></li><li><a href="/pages/0a1c8e/" class="sidebar-link">Web开发：定义系统启动任务</a></li><li><a href="/pages/d415df/" class="sidebar-link">Web开发：Swagger文档</a></li><li><a href="/pages/0d3c4b/" class="sidebar-link">Web开发：文件上传</a></li><li><a href="/pages/057f3e/" class="sidebar-link">SpringBoot整合SpringSecurity</a></li><li><a href="/pages/ad6b6d/" class="sidebar-link">SpringBoot整合验证码框架</a></li><li><a href="/pages/972103/" class="sidebar-link">SpringBoot根据IP解析地理位置信息</a></li><li><a href="/pages/f98bfa/" class="sidebar-link">SpringBoot创建二维码</a></li><li><a href="/pages/180eb2/" class="sidebar-link">SpringBoot动态定时任务</a></li><li><a href="/pages/99b3fd/" class="sidebar-link">SpringBoot接入支付宝支付</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>SpringCloud</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>MyBatis</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/back-end/#后端" data-v-06225672>后端</a></li><li data-v-06225672><a href="/back-end/#SpringBoot" data-v-06225672>SpringBoot</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/mengyahui" target="_blank" title="作者" class="beLink" data-v-06225672>MYH</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2023-02-26</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">默认日志管理与logback<!----></h1>  <div class="theme-vdoing-content content__default"><p>SpringBoot 默认为 Log4j、Logback 等常见的日志框架提供了自动化配置组件，每种 Logger 都可以通过配置在控制台或者文件中输出日志内容。默认情况下会使用 Logback 来管理日志。</p> <h2 id="一、如何选择日志框架"><a href="#一、如何选择日志框架" class="header-anchor">#</a> 一、如何选择日志框架？</h2> <p>首先，在代码层面，不必纠结是使用 Logback还是 Log4j，因为 SpringBoot 使用的是<strong>日志门面+日志实现</strong>。其中日志门面最常用的就是 Slf4j，SpringBoot 默认使用的页数 Slf4j + Logback 的组合。</p> <p>Slf4j 全称是 Simple Logging Facade for Java，即简单日志门面，它并不是一个具体的日志解决方案，实际工作的还是 Logback 或 Log4j 这样的日志框架。在写代码时，只需要依赖 Slf4j 这样一个抽象的日志门面，而具体的实现会在 Slf4j 门面调用时委托给具体的实现。</p> <h2 id="二、日志元素"><a href="#二、日志元素" class="header-anchor">#</a> 二、日志元素</h2> <p>在启动 SpringBoot 项目时，在控制台通常会有如下信息：</p> <p><img src="https://cdn.staticaly.com/gh/mengyahui/image-repository@master/springboot/image-20230111153807769.5p98x187iw00.jpg" alt="image-20230111153807769"></p> <p>日志的输出内容一共有七种元素，具体如下：</p> <ol><li>时间日期：精确到毫秒。</li> <li>日志级别：FATAL、ERROR、WARN、INFO、DEBUG 和 TRACE。</li> <li>进程 ID</li> <li>分隔符：标识实际日志的开始。</li> <li>线程名：方括号里面（可能会截断控制台输出）</li> <li>Logger名：通常使用源代码的类名。</li> <li>日志内容。</li></ol> <p>下面是各个日志级别的解释。</p> <ul><li><p><strong>FATAL | 致命</strong>：指明非常严重的可能会导致应用终止执行错误事件。</p></li> <li><p><strong>ERROR | 错误</strong>：指明错误事件，但应用可能还能继续运行。</p></li> <li><p><strong>WARN | 警告</strong>：指明可能潜在的危险状况。</p></li> <li><p><strong>INFO | 信息</strong>：指明描述信息，从粗粒度上描述了应用运行过程。</p></li> <li><p><strong>DEBUG | 调试</strong>：指明细致的事件信息，对调试应用最有用。</p></li> <li><p><strong>TRACE | 跟踪</strong>：指明程序运行轨迹，比DEBUG级别的粒度更细。</p></li></ul> <h2 id="三、日志输出"><a href="#三、日志输出" class="header-anchor">#</a> 三、日志输出</h2> <h3 id="_3-1-设置日志级别"><a href="#_3-1-设置日志级别" class="header-anchor">#</a> 3.1 设置日志级别</h3> <p>SpringBoot 应用，日志默认会输出到控制台，默认的级别包含：ERROR、WARN 和 INFO，若要开启 DEBUG 级别的日志，可以在 application.yml 配置文件中配置如下内容。</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">debug</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>但是在真实项目中，日志通常的配置如下：</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">logging</span><span class="token punctuation">:</span>
  <span class="token key atrule">level</span><span class="token punctuation">:</span>
    <span class="token key atrule">root</span><span class="token punctuation">:</span> info
    <span class="token key atrule">com.example.controller</span><span class="token punctuation">:</span> debug
    <span class="token key atrule">com.example.service</span><span class="token punctuation">:</span> debug

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>其中，root 表示组表示整个项目，也可以为不同的包指定不同的日志级别，但是以包为单位设置日志级别又很麻烦，可以自定义组为每一个组分别设置日志打印级别。</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">logging</span><span class="token punctuation">:</span>
  <span class="token key atrule">group</span><span class="token punctuation">:</span>
    <span class="token key atrule">server</span><span class="token punctuation">:</span> com.example.service<span class="token punctuation">,</span> com.example.controller
    <span class="token key atrule">sql</span><span class="token punctuation">:</span> com.example.mapper
  <span class="token key atrule">level</span><span class="token punctuation">:</span>
    <span class="token key atrule">root</span><span class="token punctuation">:</span> info
    <span class="token key atrule">server</span><span class="token punctuation">:</span> debug
    <span class="token key atrule">sql</span><span class="token punctuation">:</span> trace

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="_3-2-打印日志"><a href="#_3-2-打印日志" class="header-anchor">#</a> 3.2 打印日志</h3> <p>打印日志，通常需要先获取日志对象，具体如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/user&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> log <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">BookController</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>此外，获取日志对象也可以使用 Lombok 中的 <code>@Slf4j</code> 注解替代</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/user&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>拿到日志对象后，调用相应的方法即可打印日志，不同的级别可以作为方法名，打印出对应等级的日志。打印日志时，<code>{}</code> 可以作为占位符，数据在之后传入。</p> <p>另外，没有 fatal 等级的日志打印方法，因为 fatal 是指会使程序崩溃的严重错误，程序崩溃日志系统自然无法继续运行，所以打印 fatal 级别的日志没有意义。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/user&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@GetMapping</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> error <span class="token operator">=</span> <span class="token string">&quot;error&quot;</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;错误信息：{}&quot;</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">&quot;警告信息&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;一般信息&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;调试信息&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">trace</span><span class="token punctuation">(</span><span class="token string">&quot;跟踪信息&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">&quot;ok&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>控制台打印信息如下：</p> <p><img src="https://cdn.staticaly.com/gh/mengyahui/image-repository@master/springboot/image-20230111183704205.6026hypvrgw0.jpg" alt="image-20230111183704205"></p> <h2 id="四、日志配置"><a href="#四、日志配置" class="header-anchor">#</a> 四、日志配置</h2> <h3 id="_4-1日志持久化"><a href="#_4-1日志持久化" class="header-anchor">#</a> 4.1日志持久化</h3> <p>SpringBoot 项目日志的默认配置，只会输出到控制台，但是在生产环境通常都需要以文件的方式记录日志，只需要在配置文件添加几个简单的配置即可。</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">logging</span><span class="token punctuation">:</span>
  <span class="token key atrule">file</span><span class="token punctuation">:</span>
    <span class="token comment"># 使用相对路径的方式设置日志输出的位置【项目根目录目录\run.log】</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> run.log
    <span class="token comment"># 绝对路径方式将日志文件输出到 【项目所在磁盘根目录\log\spring.log】</span>
    <span class="token key atrule">path</span><span class="token punctuation">:</span> log/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>其中，<code>logging.file.name</code> 和 <code>logging.file.path</code> 只需要配置一个，若同时存在，则 path 无效，默认的日志文件名称为 <code>spring.log</code>。默认情况下，日志文件的大小达到 10MB 时会切分一次，产生新的日志文件。</p> <h3 id="_4-2-自定义日志格式"><a href="#_4-2-自定义日志格式" class="header-anchor">#</a> 4.2 自定义日志格式</h3> <p>在SpringBoot 项目的配置文件中添加如下配置，可以自定义日志输出格式。</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">logging</span><span class="token punctuation">:</span>
  <span class="token key atrule">pattern</span><span class="token punctuation">:</span>
    <span class="token key atrule">file</span><span class="token punctuation">:</span> <span class="token string">'%d{yyyy-MM-dd} === [%thread] === %-5level === %logger{50} === - %msg%n'</span>
    <span class="token key atrule">console</span><span class="token punctuation">:</span> <span class="token string">'%d{yyyy-MM-dd hh:mm:ss} [%thread] %-5level %logger{50} - %msg%n'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>下面给出了常见配置的解释</p> <table><thead><tr><th style="text-align:left;">输出格式</th> <th>说明</th></tr></thead> <tbody><tr><td style="text-align:left;">%d{yyyy-MM-dd HH:mm:ss, SSS}</td> <td>日志生产时间,输出到毫秒的时间</td></tr> <tr><td style="text-align:left;">%-5level</td> <td>输出日志级别，-5 表示左对齐并且固定输出 5 个字符，如果不足在右边补 0</td></tr> <tr><td style="text-align:left;">%-4relative</td> <td>从程序启动到创建日志记录的时间，单位毫秒，进行左对齐 且最小宽度为4</td></tr> <tr><td style="text-align:left;">%logger{50}</td> <td>logger 的名称最多50个字符</td></tr> <tr><td style="text-align:left;">%thread 或 %t</td> <td>输出当前线程名称</td></tr> <tr><td style="text-align:left;">%message 或 %msg 或 %m</td> <td>日志内容，即 logger.info(&quot;message&quot;)</td></tr> <tr><td style="text-align:left;">%class 或 %C</td> <td>输出 Java 类名</td></tr> <tr><td style="text-align:left;">%L</td> <td>输出错误行号</td></tr> <tr><td style="text-align:left;">%method 或 %M</td> <td>输出方法名</td></tr> <tr><td style="text-align:left;">%l</td> <td>输出语句所在的行数, 包括类名、方法名、文件名、行数</td></tr> <tr><td style="text-align:left;">hostName</td> <td>本地机器名</td></tr> <tr><td style="text-align:left;">hostAddress</td> <td>本地 ip 地址</td></tr></tbody></table> <h3 id="_4-3-自定义日志配置文件"><a href="#_4-3-自定义日志配置文件" class="header-anchor">#</a> 4.3 自定义日志配置文件</h3> <p>在 SpringBoot 配置文件中对日志进行的配置只适用一些简单的场景，对于比较负杂的场景，像区分 info 和 error 的日志、每天产生一个日志文件等无法满足，使用配置文件实现则更加合适。</p> <p>对于 logback 来说，支持 logback-spring.xml、logback-spring.groovy、logback.xml、logback.groovy 这四种日志文件名，将日志的配置文件放到 resources 目录下即可被正确加载。</p> <p>Spring 官方推荐优先使用带有 <code>-spring</code> 的文件名作为日志配置，这是因为命名为 logback-spring.xml 配置文件不会被日志框架直接加载，而是由 SpringBoot 解析日志配置文件，这意味着我们可以在 logback-spring.xml 配置文件中添加一些 SpringBoot 特有的配置项，比如获取 application.yml 中定义的数据，在 logback.xml 中是无法获取的。</p> <p>如果说不想使用上面规定的日志配置文件名，还可以自定义命名，只需要在 application.yml 中添加如下配置，且自定义命名的日志配置文件也可以添加 SpringBoot 特有的配置项。</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">logging</span><span class="token punctuation">:</span>
  <span class="token key atrule">config</span><span class="token punctuation">:</span> classpath<span class="token punctuation">:</span>logback<span class="token punctuation">-</span>core.xml
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>下面是一个完整的 logback-spring.xml 日志配置文件解析：</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token comment">&lt;!-- 
configuration根节点
	scan:当此属性设置为true时，配置文件如果发生改变，将会被重新加载，默认值为true
	scanPeriod:设置监测配置文件是否有修改的时间间隔，如果没有给出时间单位，默认单位是毫秒。
	当scan为true时，此属性生效。
	默认的时间间隔为1分钟
	debug:当此属性设置为true时，将打印出logback内部日志信息，实时查看logback运行状态。默认值为false
--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span> <span class="token attr-name">scan</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token attr-name">scanPeriod</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>60 seconds<span class="token punctuation">&quot;</span></span> <span class="token attr-name">debug</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>	
	
	<span class="token comment">&lt;!-- 子节点二：&lt;contextName&gt; 设置上下文名称
	每个logger都关联到logger上下文，默认上下文名称为“default”。但可以使用设置成其他名字，
	用于区分不同应用程序的记录。一旦设置，不能修改,可以通过%contextName来打印日志上下文名称，
	一般来说我们不用这个属性，可有可无。
	&lt;contextName&gt;logback&lt;/contextName&gt; --&gt;</span>

	<span class="token comment">&lt;!-- 子节点三：&lt;property&gt; 设置变量
	用来定义变量值的标签， 有两个属性，name和value，其中name的值是变量的名称，value的值时变量定义的值。
	通过定义的值会被插入到logger上下文中。定义变量后，可以使“${}”来使用变量。
	这里可以看后通过 application.yml 传递参数过来。
	--&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>log.pattern<span class="token punctuation">&quot;</span></span> 
              <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{20} - [%method,%line] - %msg%n<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>logback.logdir<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>E:/logs<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>logback.appname<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>appname<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
	
	<span class="token comment">&lt;!-- 子节点四：&lt;appender&gt;
	appender用来格式化日志输出节点，有两个属性name和class，class用来指定哪种输出策略，
	常用就是控制台输出策略和文件输出策略。 
	--&gt;</span>	
	<span class="token comment">&lt;!--输出到控制台 class为ConsoleAppender--&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>console<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.core.ConsoleAppender<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token comment">&lt;!--展示格式， layout和encoder都可以将事件转换为格式化后的日志记录，
			但是控制台输出使用layout或者encoder，文件输出使用encoder,layout中的pattern标签规定输出格式
		--&gt;</span>
		<span class="token comment">&lt;!--			
        &lt;layout class=&quot;ch.qos.logback.classic.PatternLayout&quot;&gt;
            &lt;pattern&gt;%d{HH:mm:ss.SSS} %contextName [%thread] %-5level %logger{36} - %msg%n&lt;/pattern&gt;
        &lt;/layout&gt;
		--&gt;</span>
		
		<span class="token comment">&lt;!-- &lt;encoder&gt;表示对日志进行编码：
			 %d{HH: mm:ss.SSS}——日志输出时间
			 %thread——输出日志的进程名字，这在Web应用以及异步任务处理中很有用
			 %-5level——日志级别，并且使用5个字符靠左对齐
			 %logger{20}——日志输出者的名字
			 %msg——日志消息
			 %n——平台的换行符  --&gt;</span>

		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">&gt;</span></span>${log.pattern}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>charset</span><span class="token punctuation">&gt;</span></span>UTF-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>charset</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">&gt;</span></span>
		
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">&gt;</span></span>
		
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>STDOUT<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.core.ConsoleAppender<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!--
                颜色可选
                &quot;%black&quot;, &quot;%red&quot;, &quot;%green&quot;,&quot;%yellow&quot;,&quot;%blue&quot;, &quot;%magenta&quot;,&quot;%cyan&quot;, &quot;%white&quot;, &quot;%gray&quot;,
                &quot;%boldRed&quot;,&quot;%boldGreen&quot;, &quot;%boldYellow&quot;, &quot;%boldBlue&quot;, &quot;%boldMagenta&quot;,&quot;%boldCyan&quot;, 
                &quot;%boldWhite&quot; and &quot;%highlight&quot; 。
                例:%red(信息),则 信息 这两个字为红色
                其它 %p 表示level,%t表示线程名
            --&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">&gt;</span></span>
                 %white(%-40.40logger{40}) %boldMagenta(%3.3L) %blue(:) %cyan(%m%n)
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">&gt;</span></span>
	
	<span class="token comment">&lt;!-- 输出到文件,class为RollingFileAppender --&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fileInfoLog<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.core.rolling.RollingFileAppender<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    	<span class="token comment">&lt;!--如果只是想要 Info 级别的日志，只是过滤 info 还是会输出 Error 日志，因为 Error 的级别高，
    	所以我们使用下面的策略，可以避免输出 Error 的日志--&gt;</span>
    	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.classic.filter.LevelFilter<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        	<span class="token comment">&lt;!--过滤 Error--&gt;</span>
        	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>level</span><span class="token punctuation">&gt;</span></span>ERROR<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>level</span><span class="token punctuation">&gt;</span></span>
        	<span class="token comment">&lt;!--匹配到就禁止--&gt;</span>
        	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onMatch</span><span class="token punctuation">&gt;</span></span>DENY<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onMatch</span><span class="token punctuation">&gt;</span></span>
        	<span class="token comment">&lt;!--没有匹配到就允许--&gt;</span>
        	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onMismatch</span><span class="token punctuation">&gt;</span></span>ACCEPT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onMismatch</span><span class="token punctuation">&gt;</span></span>
    	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">&gt;</span></span>
    	
    	<span class="token comment">&lt;!--日志文件名称，如果没有File 属性，那么只会使用FileNamePattern的文件路径规则
        	如果同时有&lt;File&gt;和&lt;FileNamePattern&gt;，那么当天日志是&lt;File&gt;，明天会自动把今天
      	  的日志改名为今天的日期。即，&lt;File&gt; 的日志都是当天的。
   		 --&gt;</span>
    	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>File</span><span class="token punctuation">&gt;</span></span>${logback.logdir}/info.${logback.appname}.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>File</span><span class="token punctuation">&gt;</span></span>
    	<span class="token comment">&lt;!--滚动策略，按照时间滚动 TimeBasedRollingPolicy--&gt;</span>
    	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rollingPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.core.rolling.TimeBasedRollingPolicy<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        	<span class="token comment">&lt;!--文件路径,定义了日志的切分方式——把每一天的日志归档到一个文件中,以防止日志填满整个磁盘空间--&gt;</span>
        	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FileNamePattern</span><span class="token punctuation">&gt;</span></span>
              ${logback.logdir}/info.${logback.appname}.%d{yyyy-MM-dd}.log
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>FileNamePattern</span><span class="token punctuation">&gt;</span></span>
        	<span class="token comment">&lt;!--只保留最近30天的日志--&gt;</span>
        	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxHistory</span><span class="token punctuation">&gt;</span></span>30<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxHistory</span><span class="token punctuation">&gt;</span></span>
        	<span class="token comment">&lt;!--用来指定日志文件的上限大小，那么到了这个值，就会删除旧的日志--&gt;</span>
        	<span class="token comment">&lt;!--&lt;totalSizeCap&gt;1GB&lt;/totalSizeCap&gt;--&gt;</span>
    	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rollingPolicy</span><span class="token punctuation">&gt;</span></span>
    	<span class="token comment">&lt;!--日志输出编码和输出格式--&gt;</span>
   	    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span><span class="token punctuation">&gt;</span></span>
        	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>charset</span><span class="token punctuation">&gt;</span></span>UTF-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>charset</span><span class="token punctuation">&gt;</span></span>
        	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">&gt;</span></span>${log.pattern}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">&gt;</span></span>
    	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fileLog<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.core.rolling.RollingFileAppender<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>file</span><span class="token punctuation">&gt;</span></span>${log.path}/debug.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>file</span><span class="token punctuation">&gt;</span></span>
		<span class="token comment">&lt;!--滚动策略，按照大小和时间滚动 SizeAndTimeBasedRollingPolicy--&gt;</span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rollingPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fileNamePattern</span><span class="token punctuation">&gt;</span></span>
              ${logback.logdir}/%d{yyyy-MM, aux}/debug.%d{yyyy-MM-dd}.%i.log.gz
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fileNamePattern</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxFileSize</span><span class="token punctuation">&gt;</span></span>50MB<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxFileSize</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxHistory</span><span class="token punctuation">&gt;</span></span>30<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxHistory</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cleanHistoryOnStart</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>cleanHistoryOnStart</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rollingPolicy</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">&gt;</span></span>%date [%thread] %-5level [%logger{50}] %file:%line - %msg%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">&gt;</span></span>

	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fileErrorLog<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.core.rolling.RollingFileAppender<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    	<span class="token comment">&lt;!--如果只想要 Error 级别的日志，那么需要过滤一下，默认是 info 级别的，ThresholdFilter--&gt;</span>
    	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.classic.filter.ThresholdFilter<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>level</span><span class="token punctuation">&gt;</span></span>Error<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>level</span><span class="token punctuation">&gt;</span></span>
    	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">&gt;</span></span>
    	<span class="token comment">&lt;!--日志名称，如果没有File 属性，那么只会使用FileNamePattern的文件路径规则
        	如果同时有&lt;File&gt;和&lt;FileNamePattern&gt;，那么当天日志是&lt;File&gt;，明天会自动把今天
       	 的日志改名为今天的日期。即，&lt;File&gt; 的日志都是当天的。
    	--&gt;</span>
    	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>File</span><span class="token punctuation">&gt;</span></span>${logback.logdir}/error.${logback.appname}.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>File</span><span class="token punctuation">&gt;</span></span>
    	<span class="token comment">&lt;!--滚动策略，按照时间滚动 TimeBasedRollingPolicy--&gt;</span>
    	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rollingPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.core.rolling.TimeBasedRollingPolicy<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        	<span class="token comment">&lt;!--文件路径,定义了日志的切分方式——把每一天的日志归档到一个文件中,以防止日志填满整个磁盘空间--&gt;</span>
        	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FileNamePattern</span><span class="token punctuation">&gt;</span></span>
              ${logback.logdir}/error.${logback.appname}.%d{yyyy-MM-dd}.log
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>FileNamePattern</span><span class="token punctuation">&gt;</span></span>
        	<span class="token comment">&lt;!--只保留最近30天的日志--&gt;</span>
        	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxHistory</span><span class="token punctuation">&gt;</span></span>30<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxHistory</span><span class="token punctuation">&gt;</span></span>
        	<span class="token comment">&lt;!--用来指定日志文件的上限大小，那么到了这个值，就会删除旧的日志--&gt;</span>
        	<span class="token comment">&lt;!--&lt;totalSizeCap&gt;1GB&lt;/totalSizeCap&gt;--&gt;</span>
    	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rollingPolicy</span><span class="token punctuation">&gt;</span></span>
    	<span class="token comment">&lt;!--日志输出编码格式化--&gt;</span>
    	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span><span class="token punctuation">&gt;</span></span>
        	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>charset</span><span class="token punctuation">&gt;</span></span>UTF-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>charset</span><span class="token punctuation">&gt;</span></span>
        	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">&gt;</span></span>%d [%thread] %-5level %logger{20} %line - %msg%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">&gt;</span></span>
    	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">&gt;</span></span>

	<span class="token comment">&lt;!-- 子节点一: root节点是必选节点，用来指定最基础的日志输出级别，可以理解为根logger，
	只有一个level属性，用来设置打印级别, 默认值是debug。
		 可以包含零个或多个元素，标识的这个appender将会添加到这个loger。 
	--&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>root</span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>INFO<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token comment">&lt;!--标识的是console这个appender --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>console<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span> 
        <span class="token comment">&lt;!--标识的是fileInfoLog这个appender --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fileInfoLog<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span> 
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>root</span><span class="token punctuation">&gt;</span></span>

	<span class="token comment">&lt;!-- 子节点五&lt;loger&gt;
	&lt;loger&gt;用来设置某一个包或者具体的某一个类的日志打印级别、以及指定&lt;appender&gt;。
	&lt;loger&gt;仅有一个name属性，一个可选的level和一个可选的addtivity属性。
	name:用来指定受此loger约束的某一个包或者具体的某一个类。
	level:用来设置打印级别，大小写无关：TRACE, DEBUG, INFO, WARN, ERROR, ALL 和 OFF，
	还有一个特俗值INHERITED或者同义词NULL，代表强制执行上级的级别。如果未设置此属性，那么当前loger将会继承上级的级别。
	addtivity:是否向上级日志级别传递打印信息。默认是true, 发生上级和本级都打印重复时可以设置为false。 
	关于这个节点springboot给了一个上面提到的特有的配置项多环境日志输出--&gt;</span>
    
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.nianyu.demo.controller<span class="token punctuation">&quot;</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>INFO<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span>
    	<span class="token comment">&lt;!-- 指定appender --&gt;</span>
    	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fileInfoLog<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>logger</span><span class="token punctuation">&gt;</span></span>        
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.apache.ibatis<span class="token punctuation">&quot;</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>TRACE<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>java.sql.Connection<span class="token punctuation">&quot;</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>DEBUG<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>java.sql.Statement<span class="token punctuation">&quot;</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>DEBUG<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>java.sql.PreparedStatement<span class="token punctuation">&quot;</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>DEBUG<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    
    <span class="token comment">&lt;!-- springboot 提供的多环境日志配置,可以把上面的logger不要了--&gt;</span>
     <span class="token comment">&lt;!-- 开发、测试环境 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>springProfile</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dev,test<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.springframework.web<span class="token punctuation">&quot;</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>INFO<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.springboot.sample<span class="token punctuation">&quot;</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>INFO<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.nianyu<span class="token punctuation">&quot;</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>DEBUG<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>springProfile</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- 生产环境 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>springProfile</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>prod<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.springframework.web<span class="token punctuation">&quot;</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ERROR<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.springboot.sample<span class="token punctuation">&quot;</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ERROR<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.nianyu<span class="token punctuation">&quot;</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>DEBUG<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>springProfile</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br></div></div><h2 id="五、logback-spring-xml-解析"><a href="#五、logback-spring-xml-解析" class="header-anchor">#</a> 五、logback-spring.xml 解析</h2> <h3 id="_5-1-根节点-configuration"><a href="#_5-1-根节点-configuration" class="header-anchor">#</a> 5.1 根节点：<code>&lt;configuration&gt;</code></h3> <p>根节点 <code>&lt;configuration&gt;</code> 包含如下属性：</p> <ol><li>scan：当设置此属性为 true 时，配置文件如果发生改变，将会被重新加载，默认值为 true。</li> <li>scanPeriod：检测配置文件是否被修改的时间间隔，如果没有给出时间单位，默认单位是毫秒。当 scan 属性为 true 时，scanPeriod 生效，默认间隔 1 分钟。</li> <li>debug：当设置此属性为 true 时，将打印出 logback 内部日志信息，实时查看 logback 运行状态，默认值为 false。</li></ol> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span> <span class="token attr-name">scan</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token attr-name">scanPeriod</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>60 seconds<span class="token punctuation">&quot;</span></span> <span class="token attr-name">debug</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>  
    <span class="token comment">&lt;!-- 其他配置省略--&gt;</span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>根节点 <code>&lt;configuration&gt;</code> 下，有 5 个子节点，下面一一介绍。</p> <h3 id="_5-2-子节点-root"><a href="#_5-2-子节点-root" class="header-anchor">#</a> 5.2 子节点：<code>&lt;root&gt;</code></h3> <p>root 节点是必选节点，用来指定最基础的日志输出级别，只有一个 level 属性，用于设置日志打印级别，默认值为 DEBUG，且大小写无关。</p> <p><code>&lt;root&gt;</code>元素可以包含零个或多个<code>&lt;appender-ref&gt;</code>元素; 这样引用的每个 appender 都被添加到根记录器中。</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>root</span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>info<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>file_info<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>file_error<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>root</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_5-3-子节点-contentname"><a href="#_5-3-子节点-contentname" class="header-anchor">#</a> 5.3 子节点 ： <code>&lt;contentName&gt;</code></h3> <p><code>&lt;contentName&gt;</code> 节点用于设置上下文名称。每个 logger 都关联到 logger 上下文，默认上下文名称为 <code>default</code>。但可以设置成其他名字，用于区分不同应用程序的记录。一旦设置，不能修改，可以通过 <code>%contextName</code> 来打印日志上下文名称，一般来说我们不用这个属性，可有可无。</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>contextName</span><span class="token punctuation">&gt;</span></span>logback<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>contextName</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_5-4-子节点-ptoperty"><a href="#_5-4-子节点-ptoperty" class="header-anchor">#</a> 5.4 子节点：<code>&lt;ptoperty&gt;</code></h3> <p><code>&lt;property&gt;</code> 标签用于定义变量值，有两个属性 name 和 value；其中 name 的值是变量的名称，value 的值是变量定义的值，通过 <code>&lt;property&gt;</code> 节点定义的变量会被保存在 logger 的上下文中，可以使用 <code>${}</code> 来使用变量。</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>contentName<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>contentName</span><span class="token punctuation">&gt;</span></span>${contentName}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>contentName</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>注意：若需要获取 application.yml 中的参数，使用 <code>&lt;property&gt;</code> 元素是无法获取的，必须使用 <code>&lt;springProperty&gt;</code> 元素。</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>springProperty</span> <span class="token attr-name">scope</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>content<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>path<span class="token punctuation">&quot;</span></span> <span class="token attr-name">source</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>logging.file.path<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_5-5-子节点-logger"><a href="#_5-5-子节点-logger" class="header-anchor">#</a> 5.5 子节点：<code>&lt;logger&gt;</code></h3> <p>root 节点用于指定最基础的日志输出级别，而 logger 节点则用来设置某一个包或者具体的某一个类的日志打印级别，也可以通过 <code>&lt;appender-ref&gt;</code> 标签来指定 appender。</p> <p>其有如下三个属性：</p> <ul><li>name：用来指定受此 logger 约束的某一个包或者具体的某一个类。</li> <li>level：用来设置打印级别，大小写无关，除了常规的日志级别外，还支持一个特殊值 <code>INHERITED</code> 或者同义词<code>NULL</code>，代表强制执行上级的级别。如果未设置此属性，那么当前 logger 将会继承上级的级别。</li> <li>addtivity：是否向上级 logger 传递打印信息。默认是true。</li></ul> <p>这里的上级 logger 指的就是 root。在当前 logger 开启向上传递时，若 logger 与 root 打印级别一致或 logger 级别比 root 级别低时，则 logger 以及 root 配置的 appender 都会执行相应的日志。</p> <h3 id="_5-6-子节点-appender"><a href="#_5-6-子节点-appender" class="header-anchor">#</a> 5.6 子节点：<code>&lt;appender&gt;</code></h3> <p><code>&lt;appender&gt;</code> 元素用于格式化日志输出节点，有两个属性 name 和 class；其中，name 属指定 appender 的名称，class 属性用于指定采用哪种输出策略，常用的就是控制台输出策略和文件输出策略。</p> <p>下面介绍几种常用的 appender。</p> <h4 id="_5-6-1-consoleappender"><a href="#_5-6-1-consoleappender" class="header-anchor">#</a> 5.6.1 ConsoleAppender</h4> <p><code>ConsoleAppender</code> 用于将日志输出到控制台，有如下子节点：</p> <ul><li><code>&lt;encoder&gt;</code>：对日志进行格式化。其下的 <code>&lt;pattern&gt;</code> 节点用于指定日志格式，如：<code>%d{yyyy-MM-dd HH:mm:ss.SSS} %-4relative [%thread] %-5level %logger{36} - %msg%n</code></li> <li><code>&lt;target&gt;</code>：字符串 System.out 或者 System.err ，默认 System.out 。</li></ul> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span> <span class="token attr-name">scan</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stdout<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.core.ConsoleAppender<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">&gt;</span></span>%d{yyyy-MM-dd HH:mm:ss.SSS} %-4relative [%thread] %-5level %logger{36} - %msg%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>charset</span><span class="token punctuation">&gt;</span></span>UTF-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>charset</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>target</span><span class="token punctuation">&gt;</span></span>System.err<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>target</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>root</span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>info<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stdout<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>root</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h4 id="_5-6-2-fileappender"><a href="#_5-6-2-fileappender" class="header-anchor">#</a> 5.6.2 FileAppender</h4> <p><code>FileAppender</code> 用于把日志添加到文件，具有如下子节点：</p> <ul><li><code>&lt;file&gt;</code> ：被写入的文件名，可以是相对目录，也可以是绝对目录，如果上级目录不存在会自动创建，没有默认值。</li> <li><code>&lt;append&gt;</code>：如果是 true，日志被追加到文件结尾，如果是 false，清空现存文件，默认是true。</li> <li><code>&lt;encoder&gt;</code>：对日志进行格式化。</li> <li><code>&lt;prudent&gt;</code>：如果是 true，日志会被安全的写入文件，即使其他的 FileAppender 也在向此文件做写入操作，效率低，默认是 false。</li></ul> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span> <span class="token attr-name">scan</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stdout<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.core.FileAppender<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>file</span><span class="token punctuation">&gt;</span></span>run.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>file</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>append</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>append</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">&gt;</span></span>%-4relative [%thread] %-5level %logger{35} - %msg%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>root</span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>info<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>file<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>root</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h4 id="_5-6-3-rollingfileappender"><a href="#_5-6-3-rollingfileappender" class="header-anchor">#</a> 5.6.3 RollingFileAppender</h4> <p>滚动记录文件，先将日志记录到指定文件，当符合某个条件时，将日志记录到其他文件。这个是最常用的！具有如下子节点</p> <ul><li><p><code>&lt;file&gt;</code>：被写入的文件名，可以是相对目录，也可以是绝对目录，如果上级目录不存在会自动创建，没有默认值。</p></li> <li><p><code>&lt;filter&gt;</code>：表示过滤器，用法稍后讲解。</p></li> <li><p><code>&lt;append&gt;</code>：如果是 true，日志被追加到文件结尾，如果是 false，清空现存文件，默认是true。</p></li> <li><p><code>&lt;encoder&gt;</code>：对记录日志进行格式化。</p></li> <li><p><code>&lt;rollingPolicy&gt;</code>:发生滚动时，决定 RollingFileAppender 的行为，涉及文件移动和重命名。</p> <ul><li><code>&lt;fileNamePattern&gt;</code>：该节点用于生成日志文件名称的匹配格式，在没有定义日志文件大小的时候日志文件的名称格式如 <code>logFile.%d{yyyy-MM-dd}.log</code>，在定义了日志文件大小的时候日志文件的名称格式必须是如下格式 <code>logFile.%d{yyyy-MM-dd}-%i.log</code>，不然启动的时候会报错。可以设置为压缩格式，支持 zip 和 gz 这 2 种格式，如 <code>logFile.%d{yyyy-MM-dd}-%i.log.zip</code>。</li> <li><code>&lt;maxHistory&gt;</code>：日志最大的保留时间，值为整数。当文件的生成格式为 <code>logFile.%d{yyyy-MM-dd}.log</code>时，表示是以天为时间间隔的，那么该子节点所填充的值就表示日志文件的保留天数，如 30，表示最早生成的日志文件保留的天数为 30 天，30 天过后日志文件都会被删除；如果文件的生成格式为<code>logFile.%d{yyyy-MM }.log</code> 时，表示日志文件是按照月份来生成的，当把值设置为 5 的时候，表示最早的日志文件只能保存 5 个月，5 个月过后生成的日志文件都会被删除。</li> <li><code>&lt;maxFileSize&gt;</code> ：指定单个文件的大小，可以在 <strong>SizeAndTimeBasedRollingPolicy</strong> 滚动策略中使用。</li> <li><code>&lt;totalSizeCap&gt;</code>：指定文件总容量，也是在 <strong>SizeAndTimeBasedRollingPolicy</strong> 滚动策略中使用。</li> <li><code>&lt;minIndex&gt;</code>：指定窗口索引的最小值，在 <strong>FixedWindowRollingPolicy</strong> 滚动策略中使用。</li> <li><code>&lt;maxIndex&gt;</code>：指定窗口索引的最大值，当用户指定的窗口过大时，会自动将窗口设置为20。在 <strong>FixedWindowRollingPolicy</strong> 滚动策略中使用。</li></ul></li> <li><p><code>&lt;triggeringPolicy&gt;</code>: 告知 RollingFileAppender 何时激活滚动。只有一个节点:<code>&lt;maxFileSize&gt;</code>:当前活动日志文件的大小，默认值是10MB。</p></li></ul> <h3 id="_5-7-滚动策略"><a href="#_5-7-滚动策略" class="header-anchor">#</a> 5.7 滚动策略</h3> <p><code>&lt;rollingPolicy&gt;</code> 的 class 属性，用于指定滚动策略的全类名。</p> <h4 id="_5-7-1-timebasedrollingpolicy"><a href="#_5-7-1-timebasedrollingpolicy" class="header-anchor">#</a> 5.7.1 TimeBasedRollingPolicy</h4> <p>TimeBasedRollingPolicy 可能是最受欢迎的滚动策略。 它根据时间定义翻转策略，例如按天或按月。TimeBasedRollingPolicy 既负责轮转的行为，也负责触发轮转。实际上，TimeBasedRollingPolicy 同时实现了 RollingPolicy 与 TriggeringPolicy 接口。</p> <p>下面是一个，每天生成一个日志文件，保留 30 天的配置。</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>timeBasePolicy<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.core.rolling.RollingFileAppender<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rollingPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.core.rolling.TimeBasedRollingPolicy<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fileNamePattern</span><span class="token punctuation">&gt;</span></span>run.%d{yyyy-MM-dd}.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fileNamePattern</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxHistory</span><span class="token punctuation">&gt;</span></span>30<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxHistory</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rollingPolicy</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">&gt;</span></span>%-4relative [%thread] %-5level %logger{35} - %msg%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>charset</span><span class="token punctuation">&gt;</span></span>UTF-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>charset</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="_5-7-2-sizeandtimebasedrollingpolicy"><a href="#_5-7-2-sizeandtimebasedrollingpolicy" class="header-anchor">#</a> 5.7.2 SizeAndTimeBasedRollingPolicy</h4> <p>SizeAndTimeBasedRollingPolicy 是最常用的滚动策略，根据时间再根据文件大小来滚动生成文件，例如</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>file<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.core.rolling.RollingFileAppender<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rollingPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fileNamePattern</span><span class="token punctuation">&gt;</span></span>run-%d{yyyy-MM-dd}.%i.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fileNamePattern</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxFileSize</span><span class="token punctuation">&gt;</span></span>5MB<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxFileSize</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxHistory</span><span class="token punctuation">&gt;</span></span>60<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxHistory</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>totalSizeCap</span><span class="token punctuation">&gt;</span></span>20GB<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>totalSizeCap</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rollingPolicy</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">&gt;</span></span>%-4relative [%thread] %-5level %logger{35} - %msg%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>charset</span><span class="token punctuation">&gt;</span></span>UTF-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>charset</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h4 id="_5-7-3-fixedwindowrollingpolicy"><a href="#_5-7-3-fixedwindowrollingpolicy" class="header-anchor">#</a> 5.7.3 FixedWindowRollingPolicy</h4> <p>根据固定窗口算法重命名文件的滚动策略。它只实现了RollingPolicy 接口，主要的作用是定义日志文件的命名规则，它的命名规则为name + index，其中 index 作为变量，值位于 minIndex-maxIndex 之间。</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fixedWindowPolicy<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.core.rolling.RollingFileAppender<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>file</span><span class="token punctuation">&gt;</span></span>run.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>file</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rollingPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.core.rolling.FixedWindowRollingPolicy<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fileNamePattern</span><span class="token punctuation">&gt;</span></span>run-%i.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fileNamePattern</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>minIndex</span><span class="token punctuation">&gt;</span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>minIndex</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxIndex</span><span class="token punctuation">&gt;</span></span>8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxIndex</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rollingPolicy</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">&gt;</span></span>%-4relative [%thread] %-5level %logger{35} - %msg%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>triggeringPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxFileSize</span><span class="token punctuation">&gt;</span></span>5KB<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxFileSize</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>triggeringPolicy</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="_5-8-过滤器-filter"><a href="#_5-8-过滤器-filter" class="header-anchor">#</a> 5.8 过滤器：<code>&lt;filter&gt;</code></h3> <p>logback 具有过滤器的支持，允许给日志记录器 appender 配置一个或多个Filter(或者给整体配置一个或多个TurboFilter)，当满足过滤器指定的条件时，才记录日志(或不满足条件时，拒绝记录日志)。logback 支持自定义过滤器，当然 logback 也自带了一些常用的过滤器，在绝大多数时候，自带的过滤器其实就够用了，一般是不需要自定义过滤器的。</p> <p>其下，通常具有如下有三个子标签：</p> <ul><li><code>&lt;level&gt;</code>：指定作为基准的日志级别。</li> <li><code>&lt;onMatch&gt;</code>：指定匹配到过滤规则的行为。</li> <li><code>&lt;onMisMatch&gt;</code>：指定未匹配到过滤级别的行为。</li></ul> <p>下面是对指定 level 的日志过滤的过滤器使用：只记录日志级别为 error 的日志</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>file<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.core.rolling.TimeBasedRollingPolicy<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>file</span><span class="token punctuation">&gt;</span></span>run.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>file</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.classic.filter.LevelFilter<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>level</span><span class="token punctuation">&gt;</span></span>ERROR<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>level</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onMatch</span><span class="token punctuation">&gt;</span></span>ACCEPT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onMatch</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onMisMatch</span><span class="token punctuation">&gt;</span></span>DENY<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onMisMatch</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="_5-8-1-过滤器的分类"><a href="#_5-8-1-过滤器的分类" class="header-anchor">#</a> 5.8.1 过滤器的分类</h4> <p>logback 提供的过滤器有如下两大分类</p> <p>ch.qos.logback.core.filter.Filter</p> <p><img src="assets/image-20230113135727717.png" alt="image-20230113135727717"></p> <p>ch.qos.logback.classic.turbo.TurboFilter</p> <p><img src="assets/image-20230113135545965.png" alt="image-20230113135545965"></p> <p>下面是几种常用的过滤器</p> <table><thead><tr><th>过滤器</th> <th>来源</th> <th>说明</th></tr></thead> <tbody><tr><td>LevelFilter</td> <td>Filter</td> <td>对指定level的日志进行过滤。</td></tr> <tr><td>ThresholdFilter</td> <td>Filter</td> <td>对大于或等于或小于指定level的日志进行过滤。</td></tr> <tr><td>EvaluatorFilter</td> <td>Filter</td> <td>对满足或不满足指定表达式的日志进行过滤。</td></tr> <tr><td>MDCFilter</td> <td>TurboFilter</td> <td>若MDC域中存在指定的key-value，则进行记录，否者不作记录。</td></tr> <tr><td>DuplicateMessageFilter</td> <td>TurboFilter</td> <td>根据配置不记录多余的重复的日志。</td></tr> <tr><td>MarkerFilter</td> <td>TurboFilter</td> <td>针对带有指定标记的日志，进行记录(或不作记录)。</td></tr></tbody></table> <h4 id="_5-8-2-状态枚举-filterreply"><a href="#_5-8-2-状态枚举-filterreply" class="header-anchor">#</a> 5.8.2  状态枚举 FilterReply</h4> <p>对于 Filter 而言，需不需要记录日志，取决于ch.qos.logback.core.filter.Filter#decide方法的返回，该方法的返回值就是 FilterReply。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">FilterReply</span> <span class="token punctuation">{</span>
    <span class="token constant">DENY</span><span class="token punctuation">,</span>
    <span class="token constant">NEUTRAL</span><span class="token punctuation">,</span>
    <span class="token constant">ACCEPT</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">FilterReply</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ul><li><code>DENY</code>：表示不用看后面的过滤器了，这里就给拒绝了，不作记录。</li> <li><code>NEUTRAL</code>：表示需不需要记录，还需要看后面的过滤器。若所有过滤器返回的全部都是NEUTRAL，那么需要记录日志。</li> <li><code>ACCEPT</code>：表示不用看后面的过滤器了，这里就给直接同意了，需要记录。</li></ul> <h4 id="_5-8-3-thresholdfilter"><a href="#_5-8-3-thresholdfilter" class="header-anchor">#</a> 5.8.3 ThresholdFilter</h4> <p>ThresholdFilter 也被称为临界值过滤器，过滤掉低于指定临界值的日志。当日志级别等于或高于临界值时，过滤器返回 NEUTRAL；当日志级别低于临界值时，日志会被拒绝。</p> <p>下面的例子是过滤掉所有低于 INFO 级别日志的配置。</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>CONSOLE<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.core.ConsoleAppender<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>   
    <span class="token comment">&lt;!-- 过滤掉 TRACE 和 DEBUG 级别的日志--&gt;</span>   
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.classic.filter.ThresholdFilter<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>   
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>level</span><span class="token punctuation">&gt;</span></span>INFO<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>level</span><span class="token punctuation">&gt;</span></span>   
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">&gt;</span></span>   

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span><span class="token punctuation">&gt;</span></span>   
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">&gt;</span></span>   
            %-4relative [%thread] %-5level %logger{30} - %msg%n   
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">&gt;</span></span>   
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">&gt;</span></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">&gt;</span></span>   
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h4 id="_5-8-4-evaluatorfilter"><a href="#_5-8-4-evaluatorfilter" class="header-anchor">#</a> 5.8.4 EvaluatorFilter</h4> <p>EvaluatorFilter 也被称为求值过滤器，评估、鉴别日志是否符合指定条件。其子标签 <code>&lt;evaluator&gt;</code>  下的 <code>&lt;expression&gt;</code> 用于指定处理日志时过滤条件的判断。</p> <p>EvaluatorFilter 是一个抽象类，它包含了一个 EventEvaluator 对象，这个对象是实现日志取值评估的关键。主要有两个实现类，分别是 GEventEvaluator 和 JaninoEventEvaluator。GEventEvaluator 接收 Groovy 语言的条件表达式作为判断条件，JaninoEventEvaluator 接收一个 java 的判断表达式作为判断条件，logback 默认使用的是 JaninoEventEvaluator，其依赖于 Janino 相关库。</p> <p>在使用 JaninoEventEvaluator 评估器时，logback 会自动导出日志事件对象的属性到条件表达式中，所以可以直接使用以下属性。</p> <table><thead><tr><th>属性</th> <th>数据类型</th> <th>说明</th></tr></thead> <tbody><tr><td>event</td> <td>ILoggingEvent</td> <td>原始的 ILoggingEvent 对象，<code>event.getMessage()</code> 相当于下面的 <code>message</code></td></tr> <tr><td>message</td> <td>String</td> <td>logging request 的原始信息，如代码<code>log.info(“Hi {}”, name)</code>打印日志时 message 的值就是 <code>“Hi {}”</code></td></tr> <tr><td>formattedMessage</td> <td>String</td> <td>格式化后的完整信息，例如<code>String name=“Java”;log.info(“hello {}”, name);</code>，则 formattedMessage 的值就是<code>“hello Java”</code></td></tr> <tr><td>logger</td> <td>String</td> <td>logger 的名称，一般为该日志所在类的全类名</td></tr> <tr><td>loggerContext</td> <td>LoggerContextVO</td> <td>logging event 所属的 LoggerContext 对象</td></tr> <tr><td>level</td> <td>int</td> <td>logging event 的等级，可以直接使用 <code>level &gt; INFO</code> 的方式判断日志等级</td></tr> <tr><td>timeStamp</td> <td>long</td> <td>logging event 产生的时间</td></tr> <tr><td>throwable</td> <td>java.lang.Throwable</td> <td>logging event 的异常信息，如果没有异常关则值为 null。throwable 不支持序列化，所以在远程日志服务器中该值为 null</td></tr> <tr><td>throwableProxy</td> <td>IThrowableProxy</td> <td>logging event 异常的代理。如果没有异常，则值为null，但它支持序列化</td></tr></tbody></table> <p>下面是一个使用 EvaluatorFilter 过滤器的例子</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stdout<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.core.ConsoleAppender<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">&gt;</span></span>%d{yyyy-MM-dd} %-4relative [%thread] %-5level %logger{36} %msg%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>charset</span><span class="token punctuation">&gt;</span></span>UTF-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>charset</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.core.filter.EvaluatorFilter<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>evaluator</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>expression</span><span class="token punctuation">&gt;</span></span>return message.contains(&quot;user&quot;);<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>expression</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>evaluator</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onMatch</span><span class="token punctuation">&gt;</span></span>ACCEPT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onMatch</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onMisMatch</span><span class="token punctuation">&gt;</span></span>NEUTRAL<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onMisMatch</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div></div></div>  <div class="page-edit"><!----> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2023/04/10, 03:42:01</span></div></div> <div class="page-nav-wapper"><!----> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/3d8091/" class="prev">项目启动Banner配置</a></span> <span class="next"><a href="/pages/0fb413/">Web开发：静态资源配置</a>→
      </span></p></div></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="mailto:2772540969@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/mengyahui" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2022-2023
    <span>MYH | <a href="https://github.com/mengyahui/blob/main/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.67223bcb.js" defer></script><script src="/assets/js/2.316bc55b.js" defer></script><script src="/assets/js/28.39252e9a.js" defer></script>
  </body>
</html>
